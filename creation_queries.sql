-- https://github.com/zygmuntz/goodbooks-10k/blob/master/samples/books.csv
-- CSV File

CREATE DATABASE library_project;

CREATE TABLE books(
	isbn_ID text CONSTRAINT isbn_key PRIMARY KEY,
	title text,
	author text,
	publication_date float(25),
	language text,
	number_of_copies int
);

CREATE temporary TABLE temp(
book_id int,
goodreads_book_id int, 
best_book_id int,
work_id int, 
books_count int,
isbn text,
isbn13 float(25),
authors text,
original_publication_year float(25),
original_title text,
title varchar(100),
language_code varchar(10),
average_rating float(10),
ratings_count	float(10),
work_ratings_count float(10),
work_text_reviews_count float(10),
ratings_1 float(10),
ratings_2 float(10),
ratings_3 float(10),
ratings_4 float(10),
ratings_5 float(10),
image_url text,
small_image_url text
);

-- Changes depending on the file location
COPY temp
FROM 'C:\Users\maldo\Desktop\INST123\books.csv'
WITH (FORMAT CSV, HEADER, DELIMITER ',');


INSERT INTO books(isbn_ID,
	title,
	author,
	publication_date,
	language,
	number_of_copies) 
SELECT isbn13, original_title, authors, original_publication_year, language_code, books_count
FROM temp;

DROP TABLE temp;

CREATE TABLE patrons(
	patron_ID bigserial CONSTRAINT patron_key PRIMARY KEY,
	first_name varchar(50),
	last_name varchar(50),
	address text,
	phone_number bigserial,
	email_address text,
	library_card_number bigserial,
	account_balance serial
);

-- Inserting Data
INSERT INTO patrons (first_name, last_name, address, phone_number, email_address, library_card_number, account_balance) 
VALUES
('Ethan', 'Nguyen', '230 Main St., Silver Spring, MD 20910', '3015557811', 'ethan.nguyen@example.com', 12345677890, 5.99),
('Maggie', 'Park', '1100 Wayne Ave., Silver Spring, MD 20910', '3015552233', 'maggie.park@example.com', 12345677891, 0),
('Rafael', 'Reyes', '1001 Spring St., Silver Spring, MD 20910', '3015551199', 'rafael.reyes@example.com', 12345677892, 10.25),
('Samantha', 'Rojas', '901 Ellsworth Dr., Silver Spring, MD 20910', '3015559966', 'samantha.rojas@example.com', 12345677893, 0),
('Oliver', 'Sanchez', '915 Wayne Ave., Silver Spring, MD 20910', '3015559922', 'oliver.sanchez@example.com', 12345677894, 15.75),
('Elena', 'Santos', '8455 Colesville Rd., Silver Spring, MD 20910', '3015556600', 'elena.santos@example.com', 12345677895, 7.50),
('Liam', 'Scott', '1200 Blair Mill Rd., Silver Spring, MD 20910', '3015556611', 'liam.scott@example.com', 12345677896, 3.50), 
('Emily', 'Smith', '2200 Randolph Rd., Wheaton, MD 20902', '2405551122', 'emily.smith@example.com', 12345677897, 0),
('Isaac', 'Taylor', '11160 Veirs Mill Rd., Wheaton, MD 20902', '2405553322', 'isaac.taylor@example.com', 12345677898, 8.75),
('Eva', 'Thomas', '2730 University Blvd W., Wheaton, MD 20902', '2405555566', 'eva.thomas@example.com', 12345677899, 2.50),
('Evan', 'Torres', '2325 University Blvd W., Wheaton, MD 20902', '2405554433', 'evan.torres@example.com', 12345677900, 12.99),
('Nathan', 'Turner', '2301 Randolph Rd., Wheaton, MD 20902', '2405557788', 'nathan.turner@example.com', 12345677901, 5.25),
('Lila', 'Walker', '11301 Georgia Ave., Wheaton, MD 20902', '2405558877', 'lila.walker@example.com', 12345677902, 7.50),
('Katherine', 'White', '11120 New Hampshire Ave., Silver Spring, MD 20904', '2405553322', 'katherine.white@example.com', 12345677903, 3.25),
('Eli', 'Wilson', '13820 New Hampshire Ave., Silver Spring, MD 20904', '2405552255', 'eli.wilson@example.com', 12345677904, 0),
('Sophia', 'Adams', '355 Bloomingdale Ave., Federalsburg, MD 21632', '4435552233', 'sophia.adams@example.com', 12345677905, 9.99),
('Henry', 'Brown', '11916 Ocean Gtwy, Ocean City, MD 21842', '4435558877', 'henry.brown@example.com', 12345677906, 0),
('Maria', 'Garcia', '3519 E. Joppa Rd., Parkville, MD 21234', '4435554433', 'maria.garcia@example.com', 12345677907, 5.50),
('Zachary', 'Green', '512 S. Main St., North East, MD 21901', '4435556677', 'zachary.green@example.com', 12345677908, 0.50),
('Sofia', 'Hernandez', '7814 Wise Ave., Dundalk, MD 21222', '4435551122', 'sofia.hernandez@example.com', 12345677909, 7.75),
('Anthony', 'Johnson', '9810 York Rd., Cockeysville, MD 21030', '4435555566', 'anthony.johnson@example.com', 12345677910, 3.75),
('Andrew', 'Jones', '21 N. Liberty St., Centreville, MD 21617', '4435557788', 'andrew.jones@example.com', 12345677911, 6.50),
('Ava', 'Lee', '6000 Eastern Ave., Baltimore, MD 21224', '4435559988', 'ava.lee@example.com', 12345677912, 10.25),
('Oliver', 'Lopez', '2600 Liberty Heights Ave., Baltimore, MD 21215', '4435551155', 'oliver.lopez@example.com', 12345677913, 1.50),
('Ethan', 'Mitchell', '4400 Stamp Rd., Temple Hills, MD 20748', '4435558877', 'ethan.mitchell@example.com', 12345677914, 0);

CREATE TABLE book_borrowing (
  borrowing_ID bigserial CONSTRAINT borrowing_key PRIMARY KEY,
  patron_ID bigint REFERENCES patrons(patron_ID),
  isbn_ID text REFERENCES books(isbn_ID),
  borrow_date date,
  due_date date,
  return_date date
);

-- Inserting Data 

INSERT INTO book_borrowing (patron_ID, isbn_ID, borrow_date, due_date, return_date) 
VALUES 
(1, '9780007442910', '2023-05-01', '2023-05-15', '2023-05-10'),
(2, '9780060256650', '2023-05-02', '2023-05-16', NULL),
(3, '9780060513030', '2023-05-03', '2023-05-17', NULL),
(4, '9780060531040', '2023-05-04', '2023-05-18', '2023-05-12'),
(25, '9780060764890', '2023-05-05', '2023-05-19', NULL),
(6, '9780060929880', '2023-05-06', '2023-05-20', NULL),
(21, '9780307269750', '2023-05-10', '2023-05-17', NULL),
(3, '9780142001740', '2023-05-10', '2023-05-17', '2023-05-10'),
(22, '9780060531040', '2023-05-10', '2023-05-17', NULL),
(1, '9780060929880', '2023-05-10', '2023-05-17', NULL),
(7, '9780451524940', '2023-05-10', '2023-05-17', NULL),
(5, '9780060256650', '2023-05-10', '2023-05-17', '2023-05-21'),
(4, '9780060929880', '2023-05-10', '2023-05-17', NULL),
(1, '9780451524940', '2023-05-10', '2023-05-17', NULL),
(19, '9780307277670', '2023-05-10', '2023-05-17', NULL),
(3, '9780451524940', '2023-05-10', '2023-05-17', NULL),
(7, '9780060929880', '2023-05-07', '2023-05-21', '2023-05-15'),
(8, '9780061122420', '2023-05-08', '2023-05-22', NULL),
(9, '9780061234000', '2023-05-09', '2023-05-23', '2023-05-18'),
(20, '9780062024040', '2023-05-10', '2023-05-24', NULL),
(3, '9780060531040', '2022-04-01', '2022-05-01', '2022-04-28'),
(7, '9780141439470', '2022-04-02', '2022-05-02', NULL),
(13, '9780142000670', '2022-04-03', '2022-05-03', NULL),
(21, '9780307277670', '2022-04-04', '2022-05-04', '2022-05-01'),
(3, '9780316160190', '2022-04-05', '2022-05-05', '2022-05-03'),
(10, '9780316166680', '2022-04-06', '2022-05-06', NULL),
(16, '9780375751520', '2022-04-07', '2022-05-07', '2022-05-06'),
(20, '9780375826700', '2022-04-08', '2022-05-08', NULL),
(23, '9780307277670', '2022-04-09', '2022-05-09', '2022-05-08'),
(2, '9780307277670', '2022-04-10', '2022-05-10', '2022-05-09'),
(3, '9780385737940', '2022-04-11', '2022-05-11', NULL),
(7, '9780439023510', '2022-04-12', '2022-05-12', NULL),
(12, '9780451524940', '2022-04-13', '2022-05-13', '2022-05-10'),
(17, '9780553588480', '2022-04-14', '2022-05-14', '2022-05-12'),
(19, '9780618346260', '2022-04-15', '2022-05-15', '2022-05-11'),
(22, '9780679879240', '2022-04-16', '2022-05-16', NULL),
(3, '9780739326220', '2022-04-17', '2022-05-17', NULL),
(8, '9780743273560', '2022-04-18', '2022-05-18', '2022-05-16'),
(14, '9780965818670', '2022-04-19', '2022-05-19', '2022-05-17'),
(20, '9781594480000', '2022-04-20', '2022-05-20', NULL),
(5, '9780345391800', '2022-06-01', '2022-06-15', '2022-06-09'),
(15, '9780141439660', '2022-06-01', '2022-06-15', NULL),
(3, '9780060513030', '2022-06-02', '2022-06-16', NULL),
(10, '9780553816720', '2022-06-03', '2022-06-17', '2022-06-16'),
(22, '9780307269750', '2022-06-03', '2022-06-17', '2022-06-09'),
(20, '9780140385720', '2022-06-04', '2022-06-18', '2022-06-14'),
(18, '9780307277670', '2022-06-05', '2022-06-19', '2022-06-13'),
(5, '9780307275550', '2022-06-06', '2022-06-20', NULL),
(10, '9780374500020', '2022-06-07', '2022-06-21', NULL),
(17, '9780345418260', '2022-06-07', '2022-06-21', NULL),
(13, '9780553588480', '2022-06-08', '2022-06-22', NULL),
(12, '9780142001740', '2022-06-09', '2022-06-23', '2022-06-21'),
(25, '9780439655480', '2022-06-09', '2022-06-23', NULL),
(6, '9780060764890', '2022-06-10', '2022-06-24', '2022-06-20'),
(23, '9780142000670', '2022-06-11', '2022-06-25', '2022-06-23'),
(7, '9780307348140', '2022-06-12', '2022-06-26', NULL),
(8, '9780307347980', '2022-06-13', '2022-06-27', NULL),
(11, '9780553296980', '2022-06-13', '2022-06-27', NULL),
(16, '9780439023510', '2022-06-14', '2022-06-28', NULL),
(19, '9780307277670', '2022-06-15', '2022-06-29', '2022-06-25'),
(6, '9780345418260', '2022-04-01', '2022-04-15', '2022-04-12'),
(13, '9780060764890', '2022-04-03', '2022-04-17', '2022-04-15'),
(16, '9780142402510', '2022-04-04', '2022-04-18', NULL),
(3, '9780345391800', '2022-04-06', '2022-04-20', NULL),
(20, '9780142000670', '2022-04-08', '2022-04-22', NULL),
(8, '9780307277670', '2022-04-09', '2022-04-23', NULL),
(5, '9780316160190', '2022-04-11', '2022-04-25', '2022-04-21'),
(1, '9780140385720', '2022-04-14', '2022-04-28', NULL),
(24, '9780553816720', '2022-04-15', '2022-04-29', '2022-04-29'),
(19, '9780142001740', '2022-04-17', '2022-05-01', NULL),
(13, '9780060513030', '2022-04-19', '2022-05-03', NULL),
(10, '9780307347980', '2022-04-20', '2022-05-04', NULL),
(21, '9780142414930', '2022-04-22', '2022-05-06', '2022-05-03'),
(11, '9780141439470', '2022-04-23', '2022-05-07', NULL),
(6, '9780439023500', '2022-04-25', '20 22-05-09', '2022-05-07'),
(18, '9780307269750', '2022-04-27', '2022-05-11', '2022-05-10'),
(4, '9780439023480', '2022-04-28', '2022-05-12', '2022-05-11'),
(22, '9780316166680', '2022-04-30', '2022-05-14', NULL),
(14, '9780316160190', '2022-05-01', '2022-05-15', NULL),
(9, '9780307348140', '2022-05-03', '2022-05-17', '2022-05-15'),
(7, '9780345418260', '2022-10-01', '2022-10-15', '2022-10-10'),
(11, '9780307275550', '2022-10-02', '2022-10-16', '2022-10-15'),
(3, '9780142001740', '2022-10-02', '2022-10-16', NULL),
(5, '9780141439470', '2022-10-03', '2022-10-17', '2022-10-15'),
(10, '9780307269980', '2022-10-03', '2022-10-17', NULL),
(18, '9780141439470', '2022-10-04', '2022-10-18', '2022-10-16'),
(16, '9780375826700', '2022-10-04', '2022-10-18', '2022-10-17'),
(23, '9780671027350', '2022-10-05', '2022-10-19', NULL),
(1, '9780307277670', '2022-10-05', '2022-10-19', NULL),
(14, '9780553296980', '2022-10-06', '2022-10-20', '2022-10-18'),
(2, '9780060764890', '2022-10-06', '2022-10-20', '2022-10-17'),
(8, '9780451524940', '2022-10-07', '2022-10-21', NULL),
(12, '9780375751520', '2022-10-07', '2022-10-21', NULL),
(21, '9780142000670', '2022-10-08', '2022-10-22', '2022-10-19'),
(19, '9780553588480', '2022-10-08', '2022-10-22', '2022-10-20'),
(24, '9780739326220', '2022-10-09', '2022-10-23', NULL),
(25, '9780553296980', '2022-10-09', '2022-10-23', NULL),
(9, '9780307277670', '2022-10-10', '2022-10-24', '2022-10-22'),
(15, '9780439023510', '2022-10-10', '2022-10-24', '2022-10-23'),
(20, '9780374500020', '2022-10-11', '2022-10-25', NULL);

CREATE TABLE book_reservations(
	reservation_ID bigserial CONSTRAINT reservation_key PRIMARY KEY,
	patron_ID bigserial REFERENCES patrons (patron_ID),
	isbn_ID text REFERENCES books (isbn_ID),
	reservation_date date,
	expiration_date date
);

-- Interesting Data
INSERT INTO book_reservations (patron_ID, isbn_ID, reservation_date, expiration_date) VALUES
(3, '9780141439470', '2023-05-09', '2023-05-16'),
(8, '9780345391800', '2023-05-09', '2023-05-16'),
(5, '9780307277670', '2023-05-10', '2023-05-17'),
(10, '9780307269980', '2023-05-10', '2023-05-17'),
(15, '9780345803500', '2023-05-11', '2023-05-18'),
(20, '9780307275550', '2023-05-11', '2023-05-18'),
(25, '9780141439600', '2023-05-12', '2023-05-19'),
(3, '9780142000670', '2023-05-12', '2023-05-19'),
(8, '9780142001740', '2023-05-13', '2023-05-20'),
(13, '9780316160190', '2023-05-13', '2023-05-20'),
(18, '9780141439600', '2023-05-14', '2023-05-21'),
(23, '9780316166680', '2023-05-14', '2023-05-21'),
(1, '9780374500020', '2023-05-15', '2023-05-22'),
(6, '9780385333850', '2023-05-15', '2023-05-22'),
(11, '9780399155340', '2023-05-16', '2023-05-23'),
(16, '9780439023480', '2023-05-16', '2023-05-23'),
(21, '9780439358070', '2023-05-17', '2023-05-24'),
(4, '9780439655480', '2023-05-17', '2023-05-24'),
(9, '9780446675540', '2023-05-18', '2023-05-25'),
(14, '9780451524940', '2023-05-18', '2023-05-25'),
(1, '9780439655480', '2022-11-15', '2022-11-22'),
(2, '9780307277670', '2022-11-16', '2022-11-23'),
(3, '9780307277670', '2022-11-17', '2022-11-24'),
(1, '9780142000670', '2023-05-10', '2023-05-13'),
(12, '9780142414930', '2023-05-11', '2023-05-14'),
(3, '9780316160190', '2023-05-12', '2023-05-15'),
(24, '9780345391800', '2023-05-13', '2023-05-16'),
(5, '9780345418260', '2023-05-14', '2023-05-17'),
(16, '9780307269980', '2023-05-15', '2023-05-18'),
(7, '9780525478810', '2023-05-16', '2023-05-19'),
(8, '9780142000670', '2023-05-17', '2023-05-20'),
(19, '9780307277670', '2023-05-18', '2023-05-21'),
(10, '9781416914280', '2023-05-19', '2023-05-22'),
(21, '9780374500020', '2023-05-20', '2023-05-23'),
(12, '9780060256650', '2023-05-21', '2023-05-24'),
(23, '9780393970130', '2023-05-22', '2023-05-25'),
(14, '9780307277670', '2023-05-23', '2023-05-26'),
(15, '9780385333850', '2023-05-24', '2023-05-27'),
(6, '9780439655480', '2023-05-25', '2023-05-28'),
(7, '9780142000670', '2023-05-26', '2023-05-29'),
(18, '9780142000670', '2023-05-27', '2023-05-30'),
(9, '9780316769170', '2023-05-28', '2023-05-31'),
(20, '9780671027350', '2023-05-29', '2023-06-01'),
(1, '9780770430080', '2023-05-30', '2023-06-02'),
(22, '9780307347980', '2023-05-31', '2023-06-03'),
(3, '9780141439660', '2023-06-01', '2023-06-04'),
(21, '9780141439470', '2023-06-02', '2023-06-05'),
(25, '9780141439660', '2023-06-03', '2023-06-06'),
(24, '9780553588480', '2023-05-15', '2023-05-22'),
(21, '9780141439470', '2023-05-16', '2023-05-23');
